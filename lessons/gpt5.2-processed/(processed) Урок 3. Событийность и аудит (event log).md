Мы уже сделали главное: лендинг работает, а лиды с формы сохраняются. Теперь возникает следующий логичный вопрос — **насколько лендинг эффективен**.

Сколько людей вообще открывают страницу?
Сколько доходят до формы?
Сколько пытаются отправить данные — и что происходит дальше?

Чтобы отвечать на такие вопросы не «на глаз», нам нужен простой и понятный инструмент: **события конверсии**.

---

## Зачем нужен event log

Когда мы анализируем лендинг, важно видеть не только финальный результат (создан ли лид), но и путь пользователя.

Для этого мы будем сохранять события — ключевые точки «критического пути» от первого захода на страницу до успешной отправки контактов.

Так мы сможем понять, где пользователи чаще всего «отваливаются» и на каком шаге теряют интерес или сталкиваются с трудностями.

---

## Какие события будем фиксировать

Выделим события, которые отражают критический путь пользователя:

* **Открытие лендинга** — покажет, сколько людей вообще увидели страницу.
* **Отправка формы** — покажет, сколько людей дошли до попытки оставить контакты (и сколько не дошли).
* **Создание лида** — покажет, у скольких получилось успешно отправить данные.

На этих трёх точках уже можно строить воронку и видеть узкие места.

---

## Формируем модель данных для события

Чтобы события были полезны для анализа, нужно заранее определить, какие данные мы сохраняем.

Поля сущности «Событие» и базовые ограничения:

1. **Идентификатор события** — уникальная строка.
2. **Тип** — код события, чтобы понимать, что именно произошло (строка, обязательно).
3. **Источник** — откуда пришло событие. Сейчас это лендинг, но позже может пригодиться для сегментации (строка, обязательно).
4. **Полезная нагрузка** — дополнительные данные, если они нужны (например, данные формы) (объект, необязательно).
5. **Идентификатор лида** — чтобы связывать события с конкретным лидом, если он есть.
6. **Дата события** — когда именно событие произошло.

---

## Передаём задачу агенту

Дальше — внедряем систему событий в проект. Промпт не меняем:

```id="eventlog_prompt"
Ты senior backend-разработчик.

Необходимо реализовать систему отправки событий из UI лендинга и сохранение в базе данных.

Задачи:
- описать модель EventLog в Prisma: id (uuid, primary key), type (строка, обязательное), source (строка, обязательное, по-умолчанию "app"), payload (json, необязательное), leadId (связь с моделью Lead по полю id, не обязательное, при удалении Lead ставить null), createdAt (дата создания по-умолчанию)
- реализовать на уровне роутинга сохранение событий в EventLog: при открытии страницы лендинга (type=landing_view), при отправке формы лида (type=cta_click, payload=<поля формы>), при создании лида (type=lead_created, leadId=<Lead.id>)
- проверить созданные события и исправь в случае необходимости
- добавь коммит в git
- перезапусти окружение docker compose
```

---

## Проверяем, что всё работает

После внедрения:

1. Открываем лендинг.
2. Заполняем форму и отправляем.
3. Заходим в таблицу `EventLog` в базе данных.

В таблице должны появиться события — именно те, которые отражают путь пользователя: от просмотра страницы до попытки отправки формы и успешного создания лида.

---

<проверка знаний>
